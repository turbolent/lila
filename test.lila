define foo = 100;

define function adder (a) {
  function (b) {
    +(a, b);
  }
};

define add23 = adder(23);

print(as-string(add23(42)));


// fib

define function fib (n) {
  if <(n, 2) {
    n
  } else {
    +(fib(-(n, 1)),
      fib(-(n, 2)))
  }
};

fib(23);


print(as-string(function (a) { a }));

let x = 23 { "FOO"; x };

// closures
(function (x) {
  x;
  (function (z) {
    z;
    (function (y) {
      y;
      +(x, y)
     })(42)
  })(100)
})(23);


let x = 23 { "FOO"; x };

"x";

print("HELLO");

if true { false } else { true };

if true { "true" } else { "false" };

1 && true;
2 && "true";



print(let x = "bindings work" { print("ok"); x });


print(as-string((function (a, b) { b })(1, 2))); 

function () {
  true
};

function (a) {
  function (b) {
    true
  }
};


print("Hello!");


if true { "YES"; } else { "NO"  };

1;

"Test";

true;

"Test" && false;

1 || 2;



// redefinition

define function test () {
  1
};

define function use-test1 () {
  test()
};

define function test () {
  2
};

define function use-test2 () {
  test()
};

define function foo () { 1 };
define function bar (a) { 2 };
define function baz (a, b) { 3 };

// Y combinator

define function Y (f) {
  ((function (x) { x(x) })
   (function (y) {
      f(function (a) {
          y(y)(a)
        })
    }))
};

// fib using Y

define fibY = Y(function (f) {
  function (n) {
    if <(n, 2) {
      n
    } else {
      +(f(-(n, 1)),
        f(-(n, 2)))
    }
  }
});

fibY(23);

// loop using Y

Y(function (f) {
    function (x) {
      print(as-string(x));
      if (<(x, 10)) {
        f(+(x, 1))
      }
    }
  })(1);
